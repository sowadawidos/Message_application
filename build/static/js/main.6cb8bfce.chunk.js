(this.webpackJsonpmessage=this.webpackJsonpmessage||[]).push([[0],{17:function(e,s,t){},23:function(e,s,t){},28:function(e,s,t){},30:function(e,s,t){},31:function(e,s,t){},32:function(e,s,t){},34:function(e,s,t){"use strict";t.r(s);var c=t(4),a=t.n(c),n=t(18),i=t.n(n),r=(t(23),t(12)),l=t.n(r),j=t(15),o=t(8),u=(t(17),t(25),t(9)),d=(t(35),t(28),t(1)),h=function(e){var s=e.onClick,t=void 0===s?null:s,c=e.children,a=void 0===c?null:c;return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("button",{className:"sign__button",onClick:t,children:a})})},b=(t(30),t(10)),m=(t(31),t.p+"static/media/search.da3387c7.svg"),O=(t(32),t.p+"static/media/send.da88ad74.svg"),p=t(16),x=t.n(p),g=function(e){var s=e.user,t=e.messageDB,a=e.messageID,n=e.image,i=e.name,r=e.active,l=Object(c.useState)([]),j=Object(o.a)(l,2),h=j[0],m=j[1],p=Object(c.useState)(""),g=Object(o.a)(p,2),v=g[0],f=g[1],N=s.uid,_=s.displayName,S=s.photoURL;Object(c.useEffect)((function(){t&&t.collection("messages").doc("".concat(a)).collection("message").orderBy("date").onSnapshot((function(e){var s=e.docs.map((function(e){return Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id})}));m(s)}))}),[a,t]);return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:r?"chat show":"chat",children:[Object(d.jsxs)("div",{className:"chat__users",children:[Object(d.jsx)("img",{src:n,alt:"avatar"}),Object(d.jsx)("p",{children:i})]}),Object(d.jsx)("div",{className:"messages",children:h.map((function(e){return Object(d.jsx)(d.Fragment,{children:N===e.uid?Object(d.jsxs)("div",{className:"messages__left",children:[Object(d.jsxs)("div",{className:"message",children:[Object(d.jsx)("p",{className:"main__message",children:e.text}),Object(d.jsx)("p",{children:"".concat(x()(1e3*e.date-62135638488e3).fromNow())})]}),Object(d.jsx)("img",{src:e.photoURL,alt:"avatar"})]},e.id):Object(d.jsxs)("div",{className:"messages__right",children:[Object(d.jsx)("img",{src:e.photoURL,alt:"avatar"}),Object(d.jsxs)("div",{className:"message",children:[Object(d.jsx)("p",{className:"main__message",children:e.text}),Object(d.jsx)("p",{children:"".concat(x()(1e3*e.date-62135638488e3).fromNow())})]})]},e.id)})}))}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t&&t.collection("messages").doc("".concat(a)).collection("message").add({text:v,date:u.a.firestore.FieldValue.serverTimestamp(),uid:N,displayName:_,photoURL:S}),f("")},className:"send__messages",children:[Object(d.jsx)("input",{onChange:function(e){f(e.target.value)},type:"text",value:v,placeholder:"Type Your message..."}),Object(d.jsx)("button",{children:Object(d.jsx)("img",{src:O,alt:"send button"})})]})]})})},v=function(e){var s=e.user,t=e.messageDB,a=e.active,n=Object(c.useState)([]),i=Object(o.a)(n,2),r=i[0],l=i[1],j=Object(c.useState)([]),u=Object(o.a)(j,2),h=u[0],O=u[1],p=Object(c.useState)(),x=Object(o.a)(p,2),v=x[0],f=x[1],N=Object(c.useState)(),_=Object(o.a)(N,2),S=_[0],D=_[1],I=Object(c.useState)(),w=Object(o.a)(I,2),F=w[0],k=w[1];Object(c.useEffect)((function(){t&&(t.collection("users").onSnapshot((function(e){var s=e.docs.map((function(e){return Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id})}));l(s)})),t.collection("messages").onSnapshot((function(e){var s=e.docs.map((function(e){return Object(b.a)(Object(b.a)({},e.data()),{},{id:e.id})}));O(s)})))}),[t]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:a?"user__page-list show":"user__page-list",children:[Object(d.jsxs)("div",{className:"users__list",children:[Object(d.jsx)("h1",{children:"Users"}),Object(d.jsxs)("ul",{children:[Object(d.jsx)("li",{className:"user-search",children:Object(d.jsx)("a",{href:"#",children:Object(d.jsx)("img",{src:m,alt:"search"})})}),r.map((function(e){return Object(d.jsx)(d.Fragment,{children:e.uid!==s.uid?Object(d.jsxs)("li",{className:"user-logo",children:[Object(d.jsx)("button",{onClick:function(){return c=e,void(h.length>0?h.forEach((function(e){e.userFirstID!==c.uid&&e.userSecondID!==s.uid||t.collection("messages").doc("".concat(s.uid).concat(c.uid)).set({userSecondID:s.uid,userFirstID:c.uid})})):t.collection("messages").doc("".concat(s.uid).concat(c.uid)).set({userSecondID:s.uid,userFirstID:c.uid}));var c},children:Object(d.jsx)("img",{src:e.photo,alt:"photo"})}),Object(d.jsx)("p",{className:"user-logo-name",children:e.name})]},e.id):null})}))]})]}),Object(d.jsxs)("ul",{className:"user-list",children:[Object(d.jsx)("h1",{className:"user-list-title",children:"Messages"}),h.map((function(e){var t=r.filter((function(s){return s.uid===e.userFirstID})),c=r.filter((function(s){return s.uid===e.userSecondID}));return Object(d.jsx)(d.Fragment,{children:e.userFirstID===s.uid||e.userSecondID===s.uid?Object(d.jsx)("li",{children:Object(d.jsxs)("a",{onClick:function(a){return function(e,t,c,a){t.preventDefault(),f(e),s.uid===a.uid?(D(c.photo),k(c.name)):(D(a.photo),k(a.name))}(e.id,a,t[0],c[0])},href:"",className:"users",children:[Object(d.jsx)("img",{src:s.uid===e.userFirstID?c[0].photo:t[0].photo,alt:"avatar"}),Object(d.jsx)("div",{className:"user-description",children:Object(d.jsx)("h1",{className:"user-desc-unread",children:s.uid===e.userFirstID?c[0].name:t[0].name})})]})},e.id):null})}))]})]}),v?Object(d.jsx)(g,{user:s,messageDB:t,messageID:v,image:S,name:F,active:a}):null]})},f=function(e){var s=e.user,t=e.messageDB,c=(e.users,e.active);e.checkUser;return Object(d.jsx)(d.Fragment,{children:Object(d.jsx)("section",{className:"main__page",children:Object(d.jsx)("div",{className:"container",children:Object(d.jsx)(v,{user:s,messageDB:t,active:c})})})})};u.a.initializeApp({apiKey:"AIzaSyDiGHuehmVjeTB08DcTVueINPfnZ6atwTQ",authDomain:"message-appk.firebaseapp.com",projectId:"message-appk",storageBucket:"message-appk.appspot.com",messagingSenderId:"1088403228949",appId:"1:1088403228949:web:df373df2e84773f654c11c"});var N=u.a.auth(),_=u.a.firestore(),S=function(){var e=Object(c.useState)((function(){return N.currentUser})),s=Object(o.a)(e,2),t=s[0],a=s[1],n=Object(c.useState)(!0),i=Object(o.a)(n,2),r=i[0],b=i[1],m=Object(c.useState)(!1),O=Object(o.a)(m,2),p=O[0],x=O[1];Object(c.useEffect)((function(){return N.onAuthStateChanged((function(e){if(e){a(e);var s=e.uid,t=e.displayName,c=e.photoURL;_.collection("users").doc("".concat(s)).set({name:t,photo:c,uid:s})}else a(null);r&&b(!1)}))}),[r]);var g=function(){var e=Object(j.a)(l.a.mark((function e(){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new u.a.auth.GoogleAuthProvider,N.useDeviceLanguage(),e.prev=2,e.next=5,N.signInWithPopup(s);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.a.auth().signOut();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return r?"Loading...":Object(d.jsx)(d.Fragment,{children:t?Object(d.jsxs)("div",{className:"page",children:[Object(d.jsx)("header",{className:"app__header",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("button",{onClick:function(e){e.preventDefault(),x(!p)},className:p?"hamburger show":"hamburger",children:[Object(d.jsx)("span",{}),Object(d.jsx)("span",{}),Object(d.jsx)("span",{})]}),Object(d.jsx)("div",{className:"logo",children:Object(d.jsxs)("h1",{className:"logo-title",children:[Object(d.jsx)("strong",{children:"Super"}),Object(d.jsx)("span",{children:"Message app"})]})}),Object(d.jsx)("nav",{className:"app__header-nav",children:Object(d.jsxs)("ul",{className:"nav-list",children:[Object(d.jsx)("li",{className:"nav-list-text",children:Object(d.jsx)(h,{onClick:v,children:"Sign Out"})}),Object(d.jsx)("li",{className:"nav-list-text",children:Object(d.jsx)("a",{href:"",children:Object(d.jsx)("img",{src:t.photoURL})})})]})})]})}),Object(d.jsx)(f,{user:t,messageDB:_,active:p})]}):Object(d.jsxs)("div",{className:"page",children:[Object(d.jsx)("header",{className:"app__header",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("div",{className:"logo",children:Object(d.jsxs)("h1",{className:"logo-title",children:[Object(d.jsx)("strong",{children:"Super"}),Object(d.jsx)("span",{children:"Message app"})]})}),Object(d.jsx)("nav",{className:"app__header-nav",children:Object(d.jsx)("ul",{className:"nav-list",children:Object(d.jsx)("li",{className:"nav-list-text",children:Object(d.jsx)(h,{onClick:g,children:"Sign In"})})})})]})}),Object(d.jsx)("div",{className:"main__page_signout",children:Object(d.jsxs)("div",{className:"main__page_signout-text",children:[Object(d.jsxs)("h1",{className:"logo-title",children:[Object(d.jsx)("strong",{children:"Super"}),Object(d.jsx)("span",{children:"Message app"})]}),Object(d.jsx)("h1",{children:"Sign in to use application"})]})}),Object(d.jsxs)("section",{children:[Object(d.jsx)("div",{className:"wave wave1"}),Object(d.jsx)("div",{className:"wave wave2"}),Object(d.jsx)("div",{className:"wave wave3"}),Object(d.jsx)("div",{className:"wave wave4"})]})]})})},D=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,36)).then((function(s){var t=s.getCLS,c=s.getFID,a=s.getFCP,n=s.getLCP,i=s.getTTFB;t(e),c(e),a(e),n(e),i(e)}))};i.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(S,{})}),document.getElementById("root")),D()}},[[34,1,2]]]);
//# sourceMappingURL=main.6cb8bfce.chunk.js.map